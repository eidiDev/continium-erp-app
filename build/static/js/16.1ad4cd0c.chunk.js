(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{1426:function(e,t,a){"use strict";a.r(t);var n=a(21),i=a(11),o=a(12),r=a(14),l=a(13),s=a(15),c=a(3),d=a(0),m=a.n(d),u=a(1297),h=a(1304),g=a(601),f=a(188),b=a(107),v=a(1302),p=a(278),E=a(212),C=a(132),w=a(60),x=a(387),O=a(68),S=a(35),k=a(7),_=function(){return new Promise(function(e,t){k.a.get("matrizcalculocilindro/",{}).then(function(t){e({data:t.data})}).catch(function(e){t({error:e.data.message})})})},y=function(e){return new Promise(function(t,a){k.a.get("matrizcalculocilindro/".concat(e)).then(function(e){t({data:e.data})}).catch(function(e){a({error:e.data.message})})})},L=function(e){return new Promise(function(t,a){var n=e.record;console.log(n);var i="POST",o="matrizcalculocilindro/";void 0!==n.id&&""!==n.id&&(i="PATCH",o="matrizcalculocilindro/".concat(n.id)),Object(k.a)({method:i,url:o,data:n}).then(function(e){t({data:e.data})}).catch(function(e){a({error:e.response.data.error})})})},N=function(e){return new Promise(function(t,a){k.a.delete("matrizcalculocilindro/".concat(e)).then(function(e){console.log(e),t({data:e.data})}).catch(function(e){a({error:e.data.message})})})},j=[{title:"Codigo",dataIndex:"codigo",key:"codigo",render:function(e){return e}},{title:"Descri\xe7\xe3o",dataIndex:"description",key:"description",onCell:function(){return{style:{whiteSpace:"nowrap",maxWidth:200}}},render:function(e){return m.a.createElement(S.a,{title:e},e)}}],I=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(r.a)(this,Object(l.a)(t).call(this))).fetchLeftList=function(){_().then(function(t){e.setState({isLoading:!1,data:t.data.data})}).catch(function(t){e.setState({isLoading:!1}),console.log(t)})},e.state={isLoading:!0,data:[]},e.fetchLeftList(),e}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement(O.a,{loading:this.state.isLoading,columns:j,data:this.state.data,onRowClick:function(t,a){return{onClick:function(n){return e.props.onClickRow(t,a)}}}})}}]),t}(d.Component),D=a(63),z=a.n(D),R=a(111),T=function(e){function t(){var e;Object(i.a)(this,t),(e=Object(r.a)(this,Object(l.a)(t).call(this))).onHandleClickSave=function(){if(e.validator.allValid()){var t=e.state.tableList,a=Object(c.a)(Object(c.a)(e));e.setState({loading:!0,loadingTip:"Salvando registro, aguarde..."});var n=e.state.record;n.items_matriz=t,console.log(n),L({record:n}).then(function(t){e.setState({loading:!1,record:t.data}),u.a.success("Registro salva com sucesso!"),a.leftList.current.fetchLeftList()}).catch(function(t){e.setState({loading:!1}),console.log(t)})}else u.a.warning("Campos obrigat\xf3rios em branco!"),e.validator.showMessages(),e.forceUpdate()},e.handleOnClickRow=function(t,a){e.setState({record:{},tableList:[]}),e.setState({loading:!0,loadingTip:"Carregando registro, aguarde..."}),y(t.id).then(function(t){u.a.success("Registro carregada com sucesso!"),console.log(t.data.items_matriz),e.setState({record:t.data,tableList:null===t.data.items_matriz?[]:t.data.items_matriz,loading:!1,canDelete:!0}),console.log(e.state.canDelete)}).catch(function(e){u.a.error("Erro ao buscar registro, tente novamente mais tarde!"),this.setState({record:[],loading:!1})})},e.onHandleClickDelete=function(){console.log(e.state.record);var t=e.state.record,a=Object(c.a)(Object(c.a)(e));h.a.confirm({title:"Tem certeza que deseja excluir esse registro?",onOk:function(){a.setState({loading:!0,loadingTip:"Excluindo registro, aguarde..."}),N(t.id).then(function(e){u.a.success("Registro excluido com sucesso!"),a.setState({record:{codigo:"",description:"",tipo:1},loading:!1,canDelete:!1}),a.leftList.current.fetchLeftList()}).catch(function(e){console.log(e),u.a.error(e.error)}),a.setStateNew()},onCancel:function(){}})},e.handleAdd=function(){var t=e.state.item;if(""!==t.desenho&&0!==t.diametro&&0!==t.lo_bo&&""!==t.material){var a=e.state.tableList.filter(function(e){return e.desenho+"_"+e.diametro+"_"+e.lo_bo!==t.desenho+"_"+t.diametro+"_"+t.lo_bo}),n={desenho:t.desenho,diametro:t.diametro,lo_bo:t.lo_bo,material:t.material,unidade:t.unidade};a.push(n);var i=a.sort(function(e,t){return parseFloat(e.diametro)>parseFloat(t.diametro)?-1:parseFloat(e.diametro)<parseFloat(t.diametro)?1:0});e.setState({tableList:i}),u.a.success("Item adicionado!"),e.setState({item:{}})}else u.a.error("Todos os campos s\xe3o obrigat\xf3rio")},e.setStateNew=function(){e.setState({isNew:!0,loader:!0,canNew:!0,canSave:!0,canDelete:!1,loading:!1,record:{codigo:"",description:"",tipo:1},item:{desenho:"",diametro:0,lo_bo:0,material:"",unidade:""},tableList:[]})},e.state={lo_bo_title:"LO",isNew:!0,loader:!0,canNew:!0,canSave:!0,canDelete:!1,loading:!1,record:{codigo:"",description:"",tipo:1},item:{desenho:"",diametro:0,lo_bo:0,material:"",unidade:""},tableList:[]},e.setStateNew=e.setStateNew.bind(Object(c.a)(Object(c.a)(e))),e.leftList=m.a.createRef(),e.validator=new z.a({locale:"pt",messages:{default:":attribute n\xe3o pode estar vazio"}}),e.handleChange=e.handleChange.bind(Object(c.a)(Object(c.a)(e))),e.handleItemChange=e.handleItemChange.bind(Object(c.a)(Object(c.a)(e))),e.onHandleClickSave=e.onHandleClickSave.bind(Object(c.a)(Object(c.a)(e)));var a=Object(c.a)(Object(c.a)(e));return e.matrizColumns=[{title:"Desenho",dataIndex:"desenho",key:"desenho"},{title:"Diametro",dataIndex:"diametro",key:"diametro",sorter:function(e,t){return e.diametro-t.diametro}},{title:"LO/BO",dataIndex:"lo_bo",key:"lo_bo",sorter:function(e,t){return e.lo_bo-t.lo_bo}},{title:"Material",dataIndex:"material",key:"material"},{title:"Unidade",dataIndex:"unidade",key:"unidade"},{title:"A\xe7\xf5es",key:"action",render:function(e,t){return m.a.createElement("div",null,m.a.createElement("i",{className:"icon icon-trash",style:{marginRight:"10px"},onClick:function(e){h.a.confirm({title:"Tem certeza que deseja remover esta linha?",onOk:function(){a.handleDeleteAddressRow(t.desenho,t.diametro,t.lo_bo,e),u.a.success("Item removido")},onCancel:function(){}})}}),m.a.createElement("i",{className:"icon icon-edit",style:{marginLeft:"20px",marginRight:"10px"},onClick:function(e){a.handleEditRow(t,e)}}))}}],e}return Object(s.a)(t,e),Object(o.a)(t,[{key:"handleChange",value:function(e){var t=this.state.record;void 0===e.target?(t.tipo=e,1===e?this.setState({lo_bo_title:"LO"}):this.setState({lo_bo_title:"BO"})):t[e.target.name]=e.target.value,this.setState({record:t})}},{key:"handleItemChange",value:function(e){var t=this.state.item;void 0===e.target?t.tipo=e:t[e.target.name]=e.target.value,this.setState({item:t})}},{key:"handleDeleteAddressRow",value:function(e,t,a,n){var i=this.state.tableList.filter(function(n){return n.desenho+"_"+n.diametro+"_"+n.lo_bo!==e+"_"+t+"_"+a});this.setState({tableList:i})}},{key:"handleEditRow",value:function(e,t){t.preventDefault();var a=this.state.tableList.find(function(t){return t.desenho===e.desenho&&t.diametro===e.diametro});this.setState({item:Object(n.a)({},a)})}},{key:"render",value:function(){return m.a.createElement(g.a,{spinning:this.state.loading,tip:this.state.loadingTip},m.a.createElement(f.a,null,m.a.createElement(b.a,{lg:5,md:5,sm:24,xs:24},m.a.createElement(I,{ref:this.leftList,onClickRow:this.handleOnClickRow})),m.a.createElement(b.a,{lg:15,md:15,sm:24,xs:24},m.a.createElement("div",{className:"main"},m.a.createElement(f.a,null,m.a.createElement(b.a,{span:24},m.a.createElement(v.a,{layout:"horizontal",size:"small"},m.a.createElement(p.a,{type:"inner",title:"Tabela de Haste / Camisa "},m.a.createElement(f.a,null,m.a.createElement(b.a,{lg:6,md:8,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"C\xf3digo",required:!0},m.a.createElement(E.a,{type:"text",value:this.state.record.codigo,name:"codigo",disabled:!this.state.isNew,onChange:this.handleChange}),this.validator.message("codigo",this.state.record.codigo,"required",{className:"text-danger"})))),m.a.createElement(b.a,{lg:12,md:12,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Descri\xe7\xe3o",required:!0},m.a.createElement(E.a,{type:"text",value:this.state.record.description,name:"description",disabled:!this.state.isNew,onChange:this.handleChange}),this.validator.message("description",this.state.record.description,"required",{className:"text-danger"})))),m.a.createElement(b.a,{lg:6,md:8,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Tipo"},m.a.createElement(C.a,{onChange:this.handleChange,value:this.state.record.tipo,defaultValue:1},m.a.createElement(C.a.Option,{value:1},"Haste"),m.a.createElement(C.a.Option,{value:2},"Camisa"))))))),m.a.createElement(p.a,{type:"inner",title:"Matriz"},m.a.createElement(f.a,null,m.a.createElement(b.a,{lg:4,md:4,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Desenho"},m.a.createElement(E.a,{value:this.state.item.desenho,type:"text",name:"desenho",onChange:this.handleItemChange})))),m.a.createElement(b.a,{lg:3,md:3,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Diametro"},m.a.createElement(E.a,{value:this.state.item.diametro,type:"text",name:"diametro",onChange:this.handleItemChange})))),m.a.createElement(b.a,{lg:3,md:3,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:this.state.lo_bo_title},m.a.createElement(E.a,{value:this.state.item.lo_bo,type:"number",step:".01",min:"0",name:"lo_bo",onChange:this.handleItemChange})))),m.a.createElement(b.a,{lg:4,md:4,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Material"},m.a.createElement(E.a,{value:this.state.item.material,type:"string",name:"material",onChange:this.handleItemChange})))),m.a.createElement(b.a,{lg:4,md:4,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(v.a.Item,{label:"Unidade"},m.a.createElement(E.a,{value:this.state.item.unidade,type:"string",name:"unidade",onChange:this.handleItemChange})))),m.a.createElement(b.a,{lg:6,md:6,sm:12,xs:24},m.a.createElement("div",{className:"gx-form-row0"},m.a.createElement(w.a,{type:"primary",style:{marginTop:40},htmlType:"submit",disabled:!1,onClick:this.handleAdd},"Adicionar")))),m.a.createElement(f.a,null,m.a.createElement(b.a,{span:24},m.a.createElement(x.a,{className:"gx-table-responsive",columns:this.matrizColumns,dataSource:this.state.tableList,size:"small",rowKey:"id"}))))))))),m.a.createElement(b.a,{lg:4,md:4,sm:24,xs:24},m.a.createElement(R.a,{title:"A\xe7\xf5es",onHandleClickNew:this.setStateNew,onHandleClickSave:this.onHandleClickSave,onHandleClickDelete:this.onHandleClickDelete,canNew:this.state.canNew,canSave:this.state.canSave,canDelete:this.state.canDelete}))))}}]),t}(d.Component);t.default=T}}]);
//# sourceMappingURL=16.1ad4cd0c.chunk.js.map